import FreeCAD
import Part
import math

def create_half_gear():
    # پارامترهای چرخ دنده (متناسب با چرخ دنده شانه‌ای قبلی)
    module = 1.0           # باید همانند چرخ دنده شانه‌ای باشد
    teeth = 12             # تعداد دندانه‌ها
    pressure_angle = 20    # زاویه فشار (درجه)
    thickness = 12.0       # ضخامت (همانند عرض چرخ دنده شانه‌ای)
    gear_radius = (teeth * module) / 2  # شعاع چرخ دنده
    
    # ایجاد چرخ دنده کامل
    gear = Part.makeGear(module, teeth, pressure_angle, thickness)
    
    # ایجاد صفحه برش برای نیمه کردن چرخ دنده
    cut_plane = Part.makePlane(gear_radius * 3, gear_radius * 3, 
                              FreeCAD.Vector(0, -gear_radius, 0), 
                              FreeCAD.Vector(0, 1, 0))
    
    # برش چرخ دنده به دو نیمه
    half_gear = gear.cut(cut_plane)
    
    # ایجاد قسمت استوانه‌ای صاف برای نیمه دیگر
    cylinder = Part.makeCylinder(gear_radius, thickness, 
                                FreeCAD.Vector(0, 0, 0), 
                                FreeCAD.Vector(0, 0, 1))
    cylinder = cylinder.cut(cut_plane)
    
    # ترکیب نیمه چرخ دنده با استوانه صاف
    final_gear = half_gear.fuse(cylinder)
    
    # ایجاد شیء در سند
    doc = FreeCAD.ActiveDocument
    if doc is None:
        doc = FreeCAD.newDocument("GearAssembly")
    
    gear_obj = doc.addObject("Part::Feature", "HalfGear")
    gear_obj.Shape = final_gear
    
    # تنظیمات نمایش
    gear_obj.ViewObject.ShapeColor = (0.33, 0.67, 0.93)  # رنگ آبی
    doc.recompute()
    
    return gear_obj

# اجرای تابع
half_gear = create_half_gear()
