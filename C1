import FreeCAD
import Part
from FreeCAD import Base

# ایجاد سند جدید
doc = FreeCAD.newDocument("PreciseCutCylinder")

# پارامترهای جدید
diameter = 16.0    # قطر به میلی‌متر (16mm)
radius = diameter / 2
length = 80.0      # طول به میلی‌متر (معادل 8cm قبلی اما در مقیاس میلی‌متر)
middle_offset = 4.0  # فاصله برش از مرکز به میلی‌متر (4mm آنورتر از وسط)

# ایجاد استوانه اصلی
cylinder = Part.makeCylinder(radius, length, Base.Vector(0,0,0), Base.Vector(0,0,1))

# ایجاد جعبه برش با عرض بسیار کم برای دقت بیشتر
cut_thickness = 0.1  # ضخامت بسیار کم برش (0.1mm)
cut_box = Part.makeBox(cut_thickness, diameter*2, length*2,
                      Base.Vector(middle_offset - cut_thickness, -diameter, -length))

# انجام عملیات برش
result = cylinder.cut(cut_box)

# اضافه کردن شیء به سند
cylinder_obj = doc.addObject("Part::Feature", "PreciselyCutCylinder")
cylinder_obj.Shape = result

# تنظیم نمایش
FreeCADGui.ActiveDocument.ActiveView.viewAxometric()
FreeCADGui.SendMsgToActiveView("ViewFit")
doc.recompute()
