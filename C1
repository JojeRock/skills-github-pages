import FreeCAD
import Part
from FreeCAD import Base

# ایجاد سند جدید
doc = FreeCAD.newDocument("PrecisionCutCylinder")

# پارامترهای استوانه
diameter = 16.0  # قطر به میلی‌متر (1.6 سانت)
radius = diameter / 2  # 8mm
length = 80.0    # طول به میلی‌متر (8 سانت)
extra_offset = 4.0  # 4 میلی‌متر آن‌سوتر از مرکز
total_offset = radius + extra_offset  # 8 + 4 = 12mm از مرکز

# ایجاد استوانه اصلی
cylinder = Part.makeCylinder(radius, length, Base.Vector(0,0,0), Base.Vector(0,0,1))

# ایجاد ابزار برش با دقت بالا
cut_thickness = 0.01  # ضخامت بسیار نازک برای دقت
cut_height = length * 1.5  # ارتفاع بیشتر از استوانه
cut_width = diameter * 3   # عرض کافی
cut_box = Part.makeBox(cut_thickness, cut_width, cut_height,
                      Base.Vector(total_offset - cut_thickness, 
                                 -cut_width/2, 
                                 -cut_height/2))

# انجام عملیات برش
final_shape = cylinder.cut(cut_box)

# اضافه کردن به سند
result_obj = doc.addObject("Part::Feature", "Cylinder_4mmOffsetCut")
result_obj.Shape = final_shape

# بهینه‌سازی نمایش
FreeCADGui.ActiveDocument.ActiveView.viewAxometric()
FreeCADGui.SendMsgToActiveView("ViewFit")
doc.recompute()

print(f"استوانه با قطر {diameter}mm و طول {length}mm ایجاد شد")
print(f"برش از {total_offset}mm از مرکز انجام شد (شعاع: {radius}mm + اضافه: {extra_offset}mm)")
