import FreeCAD
import Part
from FreeCAD import Base

doc = FreeCAD.newDocument("DirectCylinderPart")

# پارامترها (مقیاس میلیمتر)
total_diameter = 16.0
total_radius = total_diameter / 2
cylinder_length = 80.0
cut_position = 5.0  # فاصله برش از مرکز

# محاسبه اندازه قسمت باقیمانده
remaining_length = total_radius + cut_position  # 8 + 5 = 13mm

# 1. ایجاد کمان دایره برای مقطع
circle = Part.Circle()
circle.Radius = total_radius

# 2. ایجاد کمان از 5mm تا لبه راست (180 درجه)
arc = Part.ArcOfCircle(
    circle,
    -math.acos(cut_position/total_radius),  # زاویه شروع
    math.acos(cut_position/total_radius)    # زاویه پایان
)

# 3. ایجاد خط مستقیم برای برش
edge1 = Part.LineSegment(
    Base.Vector(cut_position, -math.sqrt(total_radius**2 - cut_position**2), 0),
    Base.Vector(cut_position, math.sqrt(total_radius**2 - cut_position**2), 0)
).toShape()

# 4. ساخت مقطع
wire = Part.Wire([arc.toShape(), edge1])

# 5. اکسترود به طول استوانه
final_shape = wire.extrude(Base.Vector(0, 0, cylinder_length))

# اضافه کردن به سند
obj = doc.addObject("Part::Feature", "FinalCylinderPart")
obj.Shape = final_shape

# تنظیمات نمایش
FreeCADGui.ActiveDocument.ActiveView.viewAxometric()
FreeCADGui.SendMsgToActiveView("ViewFit")
doc.recompute()
