import FreeCAD
import Part
from FreeCAD import Base

# 1. ایجاد سند جدید
doc = FreeCAD.newDocument("FinalCorrectCutCylinder")

# 2. تنظیم پارامترها (همه مقادیر بر حسب میلیمتر)
total_diameter = 16.0
total_radius = total_diameter / 2  # 8mm
cylinder_length = 80.0
cut_distance_from_center = 5.0  # برش 5mm از مرکز به سمت راست

# 3. محاسبه محدوده حذف
# قسمت چپ باید از -8mm تا +5mm حذف شود (طول 13mm)
delete_start = -total_radius  # -8mm (لبه چپ استوانه)
delete_width = total_radius + cut_distance_from_center  # 8 + 5 = 13mm

# 4. ایجاد استوانه اصلی
main_cylinder = Part.makeCylinder(
    total_radius, 
    cylinder_length, 
    Base.Vector(0, 0, 0), 
    Base.Vector(0, 0, 1)
)

# 5. ایجاد جعبه حذف با ابعاد تضمینی
delete_box = Part.makeBox(
    delete_width,                   # عرض: 13mm
    total_diameter * 1.5,           # ارتفاع: بزرگتر از قطر
    cylinder_length * 1.5,          # طول: بزرگتر از طول استوانه
    Base.Vector(delete_start,       # نقطه شروع X: -8mm
                -total_radius * 1.5, # Y: پایین تر از مرکز
                -cylinder_length * 0.5) # Z: قبل از شروع استوانه
)

# 6. عملیات حذف نهایی
result = main_cylinder.cut(delete_box)

# 7. ایجاد شیء نهایی
final_object = doc.addObject("Part::Feature", "KeptRightPart")
final_object.Shape = result

# 8. تنظیمات نمایش
FreeCADGui.ActiveDocument.ActiveView.viewAxometric()
FreeCADGui.SendMsgToActiveView("ViewFit")
doc.recompute()
