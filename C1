import FreeCAD
import Part
from FreeCAD import Base

def create_cut_cylinder():
    # ایجاد سند جدید
    doc = FreeCAD.ActiveDocument
    if doc is None:
        doc = FreeCAD.newDocument("CutCylinderDoc")
    
    # پارامترهای طراحی
    diameter = 16.0  # 1.6cm به میلیمتر
    radius = diameter / 2
    length = 80.0    # 8cm به میلیمتر
    extra_cut = 4.0   # 4mm آنورتر از مرکز
    
    # محاسبه موقعیت برش
    cut_position = radius + extra_cut  # 8 + 4 = 12mm از مرکز
    
    # ایجاد استوانه اصلی
    cylinder = Part.makeCylinder(radius, length, Base.Vector(0,0,0), Base.Vector(0,0,1))
    
    # ایجاد ابزار برش (یک نیمه بینهایت)
    # روش مطمئن‌تر: استفاده از یک جعبه بزرگ به عنوان نیمفضا
    cut_tool = Part.makeBox(100, 100, length*2,
                          Base.Vector(cut_position, -50, -length))
    
    # اعمال برش
    cut_cylinder = cylinder.cut(cut_tool)
    
    # بررسی نتیجه
    if cut_cylinder.Volume == cylinder.Volume:
        FreeCAD.Console.PrintError("برش انجام نشد! بررسی پارامترها\n")
        return
    
    # اضافه کردن به سند
    obj = doc.addObject("Part::Feature", "CutCylinder")
    obj.Shape = cut_cylinder
    
    # تنظیمات نمایش
    FreeCADGui.ActiveDocument.ActiveView.viewAxometric()
    FreeCADGui.SendMsgToActiveView("ViewFit")
    doc.recompute()
    
    FreeCAD.Console.PrintMessage(f"استوانه با برش {extra_cut}mm آنورتر از مرکز ایجاد شد\n")

create_cut_cylinder()
